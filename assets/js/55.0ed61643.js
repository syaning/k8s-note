(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{369:function(t,s,a){"use strict";a.r(s);var e=a(42),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#service"}},[t._v("#")]),t._v(" Service")]),t._v(" "),a("p"),a("div",{staticClass:"table-of-contents"},[a("ul",[a("li",[a("a",{attrs:{href:"#类型"}},[t._v("类型")])]),a("li",[a("a",{attrs:{href:"#创建-service"}},[t._v("创建 Service")]),a("ul",[a("li",[a("a",{attrs:{href:"#clusterip"}},[t._v("ClusterIP")])]),a("li",[a("a",{attrs:{href:"#nodeport"}},[t._v("NodePort")])]),a("li",[a("a",{attrs:{href:"#loadbalancer"}},[t._v("LoadBalancer")])]),a("li",[a("a",{attrs:{href:"#externalname"}},[t._v("ExternalName")])])])]),a("li",[a("a",{attrs:{href:"#多端口"}},[t._v("多端口")])]),a("li",[a("a",{attrs:{href:"#服务发现"}},[t._v("服务发现")]),a("ul",[a("li",[a("a",{attrs:{href:"#环境变量"}},[t._v("环境变量")])]),a("li",[a("a",{attrs:{href:"#dns"}},[t._v("DNS")])])])]),a("li",[a("a",{attrs:{href:"#headless-service"}},[t._v("Headless Service")])]),a("li",[a("a",{attrs:{href:"#对外提供服务"}},[t._v("对外提供服务")])]),a("li",[a("a",{attrs:{href:"#参考"}},[t._v("参考")])])])]),a("p"),t._v(" "),a("h2",{attrs:{id:"类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#类型"}},[t._v("#")]),t._v(" 类型")]),t._v(" "),a("ul",[a("li",[t._v("ClusterIP：默认类型，会分配一个集群内可访问的虚拟 IP")]),t._v(" "),a("li",[t._v("NodePort：会暴露一个端口出去，通过 "),a("code",[t._v("<NodeIP>:<NodePort>")]),t._v(" 可以访问")]),t._v(" "),a("li",[t._v("LoadBalancer：使用云服务商提供的负载均衡器对外提供服务")]),t._v(" "),a("li",[t._v("ExternalName：转发到其它服务上")])]),t._v(" "),a("h2",{attrs:{id:"创建-service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建-service"}},[t._v("#")]),t._v(" 创建 Service")]),t._v(" "),a("h3",{attrs:{id:"clusterip"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#clusterip"}},[t._v("#")]),t._v(" ClusterIP")]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Service\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ClusterIP\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("selector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("protocol")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TCP\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targetPort")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n")])])]),a("p",[t._v("其中 "),a("code",[t._v("port")]),t._v(" 是 Service 对外暴露的端口，"),a("code",[t._v("targetPort")]),t._v(" 是目标 Pod 的端口。在不声明的情况下，"),a("code",[t._v("targetPort")]),t._v(" 默认和 "),a("code",[t._v("port")]),t._v(" 保持一致。")]),t._v(" "),a("h3",{attrs:{id:"nodeport"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nodeport"}},[t._v("#")]),t._v(" NodePort")]),t._v(" "),a("p",[a("code",[t._v("NodePort")]),t._v(" 类型的 Service 可以使用 "),a("code",[t._v("<NodeIP>:<NodePort>")]),t._v(" 来访问，例如：")]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Service\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" NodePort\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("selector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("protocol")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TCP\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targetPort")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("nodePort")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("32080")]),t._v("\n")])])]),a("p",[t._v("如果不指定 "),a("code",[t._v("nodePort")]),t._v("，系统会默认分配一个端口。默认的端口范围是 "),a("code",[t._v("30000-32767")]),t._v("。")]),t._v(" "),a("p",[t._v("更多详情参考 "),a("a",{attrs:{href:"https://kubernetes.io/docs/concepts/services-networking/service/#nodeport",target:"_blank",rel:"noopener noreferrer"}},[t._v("Type NodePort"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"loadbalancer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#loadbalancer"}},[t._v("#")]),t._v(" LoadBalancer")]),t._v(" "),a("p",[t._v("通过云服务商提供的负载均衡器对外暴露服务。")]),t._v(" "),a("p",[t._v("更多详情参考 "),a("a",{attrs:{href:"https://kubernetes.io/docs/concepts/services-networking/service/#loadbalancer",target:"_blank",rel:"noopener noreferrer"}},[t._v("Type LoadBalancer"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"externalname"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#externalname"}},[t._v("#")]),t._v(" ExternalName")]),t._v(" "),a("p",[a("code",[t._v("ExternalName")]),t._v(" 类型的 Service 可以在 DNS 解析阶段，将服务地址解析成另一个外部服务的地址，从而进行访问。例如：")]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Service\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" httpbin\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ExternalName\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("externalName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" httpbin.org\n")])])]),a("p",[t._v("更多详情参考 "),a("a",{attrs:{href:"https://kubernetes.io/docs/concepts/services-networking/service/#externalname",target:"_blank",rel:"noopener noreferrer"}},[t._v("Type ExternalName"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"多端口"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#多端口"}},[t._v("#")]),t._v(" 多端口")]),t._v(" "),a("p",[t._v("一个 Service 可以对外暴露多个端口，此时应当为每个端口指定一个 "),a("code",[t._v("name")]),t._v("：")]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Service\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("service\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("selector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" my"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("app\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" http\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("protocol")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TCP\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targetPort")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9376")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" https\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("protocol")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TCP\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targetPort")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9377")]),t._v("\n")])])]),a("h2",{attrs:{id:"服务发现"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务发现"}},[t._v("#")]),t._v(" 服务发现")]),t._v(" "),a("h3",{attrs:{id:"环境变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#环境变量"}},[t._v("#")]),t._v(" 环境变量")]),t._v(" "),a("p",[t._v("详情参考 "),a("a",{attrs:{href:"https://kubernetes.io/docs/concepts/services-networking/service/#environment-variables",target:"_blank",rel:"noopener noreferrer"}},[t._v("Environment variables"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("p",[t._v("由于对服务启动顺序有依赖，因此实际很少使用。")]),t._v(" "),a("h3",{attrs:{id:"dns"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#dns"}},[t._v("#")]),t._v(" DNS")]),t._v(" "),a("p",[t._v("服务之间可以通过 "),a("code",[t._v("service-name.namespacee")]),t._v(" 的方式来互相访问，如果两个服务在同一个 namespace 下，可以直接通过 "),a("code",[t._v("service-name")]),t._v(" 来互相访问。")]),t._v(" "),a("p",[t._v("例如：")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ kubectl get svc\nNAME         TYPE        CLUSTER-IP      EXTERNAL-IP   PORT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("S"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   AGE\nnginx        ClusterIP   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.107")]),t._v(".254.54   "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/TCP    1d\n\n$ kubectl run -it --rm busybox --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("busybox:1.28.4 "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v("\nIf you don't see a "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("command")]),t._v(" prompt, try pressing enter.\n/ "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# wget http://nginx")]),t._v("\nConnecting to nginx "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.107")]),t._v(".254.54:80"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nindex.html           "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("100")]),t._v("% "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("******************************"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("612")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(":00:00 ETA\n/ "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#")]),t._v("\n/ "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# nslookup nginx.default")]),t._v("\nServer:    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.96")]),t._v(".0.10\nAddress "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.96")]),t._v(".0.10 kube-dns.kube-system.svc.cluster.local\n\nName:      nginx.default\nAddress "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.107")]),t._v(".254.54 nginx.default.svc.cluster.local\n")])])]),a("p",[t._v("可以看到 DNS 解析 "),a("code",[t._v("nginx.default")]),t._v(" 的地址就是 nginx Service 的 ClusterIP。")]),t._v(" "),a("p",[t._v("更多详情参考 "),a("a",{attrs:{href:"https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/",target:"_blank",rel:"noopener noreferrer"}},[t._v("DNS for Services and Pods"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"headless-service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#headless-service"}},[t._v("#")]),t._v(" Headless Service")]),t._v(" "),a("p",[t._v("如果显式指定 "),a("code",[t._v("clusterIP")]),t._v(" 为 "),a("code",[t._v("None")]),t._v("，那么创建出来的就是 Headless Service，通过这种方式用户可以定制负载均衡的方式。")]),t._v(" "),a("p",[t._v("Headless Service 不会被自动分配 ClusterIP，而且 DNS 解析也会直接解析为 Pod 的地址。")]),t._v(" "),a("div",{staticClass:"language-yaml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" Service\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("selector")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("app")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" nginx\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("clusterIP")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" None\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("ports")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("port")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("protocol")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" TCP\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("targetPort")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\n")])])]),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ kubectl get svc\nNAME         TYPE        CLUSTER-IP   EXTERNAL-IP   PORT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("S"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("   AGE\nnginx        ClusterIP   None         "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("none"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/TCP    16s\n\n$ kubectl get po -owide\nNAME                     READY     STATUS    RESTARTS   AGE       IP          NODE\nnginx-65fc954674-lcvcj   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1       Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          22s       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.1")]),t._v(".0.62   docker-for-desktop\nnginx-65fc954674-nsnz2   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1       Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          22s       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.1")]),t._v(".0.60   docker-for-desktop\nnginx-65fc954674-s7rmj   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/1       Running   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("          22s       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.1")]),t._v(".0.61   docker-for-desktop\n\n$ kubectl run -it --rm busybox --image"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("busybox:1.28.4 "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sh")]),t._v("\nIf you don't see a "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("command")]),t._v(" prompt, try pressing enter.\n/ "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# nslookup nginx.default")]),t._v("\nServer:    "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.96")]),t._v(".0.10\nAddress "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.96")]),t._v(".0.10 kube-dns.kube-system.svc.cluster.local\n\nName:      nginx.default\nAddress "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.1")]),t._v(".0.62\nAddress "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.1")]),t._v(".0.60\nAddress "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(": "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.1")]),t._v(".0.61\n")])])]),a("h2",{attrs:{id:"对外提供服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#对外提供服务"}},[t._v("#")]),t._v(" 对外提供服务")]),t._v(" "),a("ul",[a("li",[t._v("NodePort")]),t._v(" "),a("li",[t._v("LoadBalancer")]),t._v(" "),a("li",[a("RouterLink",{attrs:{to:"/k8s/objects/ingress.html"}},[t._v("Ingress")])],1)]),t._v(" "),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://kubernetes.io/docs/concepts/services-networking/service/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Service"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=n.exports}}]);